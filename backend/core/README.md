# Bloom Backend Services

This package is a [NestJS application](https://docs.nestjs.com/) that provides a core set of backend services via REST API endpoints to apps using the Bloom Housing framework. Information is stored in a Postgres database, accessed via [TypeORM](https://typeorm.io/).

## OpenAPI Documentation

OpenAPI (fka Swagger) documentation is automatically generated by the server at `http://localhost:3100/docs/` for a standard local development environment. A raw JSON version of the schema is also available at `/docs-json/`, suitable for API client code generation or other code-based consumers.

## Getting Started for Developers

The following steps should provide a working local environement for development purposes:

### Setting up your local environment variables

Operational configuration the service is read from environment variables. Copy `.env.template` to `.env` and edit the settings specific to your development environment. Make sure the Database URL matches your Postgres configuration.

### Setting up a Database

Dev DB reseed:

```shell script
psql -c 'DROP DATABASE bloom;' && psql -c 'CREATE DATABASE bloom;' && yarn migrate && yarn seed
```

Test DB reseed:

```shell script
psql -c 'DROP DATABASE bloom_test;' && psql -c 'CREATE DATABASE bloom_test;' && yarn typeorm-test migration:run && yarn test:seed
```

### Running Tests

End-to-end tests:

```shell script
yarn test:e2e
```

or a single module:

```shell script
yarn test:e2e test/user-applications
```
